<!DOCTYPE HTML>
<!--
	Hyperspace by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Card Shark - Trevor C.</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<a href="index.html" class="title">Trevor's Projects</a>
				<nav>
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="elements.html">Elements</a></li>
					</ul>
				</nav>
			</header>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<section id="main" class="wrapper">
						<div class="inner">
							<h1 class="major">Card Shark</h1>
							<span><img src="images/ProcessedImage_Cropped.jpg" alt="" width="50%"/></span>
							<h2>What is Card Shark?</h2>
							<p>Card Shark is an computer vision program that recognizes card and highlights the optimal
								moves to play. In particular, it's the world's best SET player!</p>
							<h2>What is SET?</h2>
								<iframe width="560" height="315" src="https://www.youtube.com/embed/NzXDfSFQ1c0"
										title="YouTube video player" frameborder="0" allow="accelerometer; autoplay;
										clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
								</iframe>
							<p>
								Set is a card game in which 12 cards are laid out, and each player has to pick out sets of 3 cards that follow specific
								patterns. Each card is identified by combination of 4 features: shape, color, and fill, and count. A set is formed,
								when each feature is either the same across all three cards, or unqiue across all three cards.
							</p>

							<h2>How it works?</h2>
							<p>
								<ol>
									<li>The application captures a frame, either from file or live video.</li>
									<li>The frame is pre-processed to filter out major variations in brightness.</li>
									<li>The frame is thresholded and we search for shapes (contours), and then filter them to keep only the ones that are the shape and size of cards.</li>
									<li>Each Card is processed to determine it's attributes:
										<ol>
											<li>Corners of card are extracted from contour, and used to project the card into a rectangle of standardized dimensions.</li>
											<li>The cards are pre-processed, converting to grayscale, blurring to reduce noise, and subtracting variation in background brightness.</li>
											<li><b>Shape and Count</b>: Thresholding is performed, to generate a silhouette of the shapes on the card.
												This silhouette is compared to ideal templates using intersection over union.</li>
											<li>The silhouettes from the previous step are treated as mask, and erode operations
											are used with some bitwise operations to generate masks that isolate the edges
												of shapes, the interior fill of shapes, and the background of the card.</li>
											<li>A copy of the image is converted into HSV space.</li>
											<li><b>Color</b>:The HSV image is masked to isolate the edge of the shape. The hue is calculated
												over the mask to find the closest color match.</li>
											<li><b>Fill/Texture</b>: A mask is used to calculate average saturation. However, it's fairly
												sensitive to lighting, so we normalize by the average saturation of the background.
												I had started by looking for stripes, but low quality webcams struggle to focus,
												so saturation proved more robust to changes in camera/lighting.</li>
												<!--Why don't we take a ratio with the edge...that would vary with focus/lighting
												just as much, and the solid fill will scale with lighting/focus, giving us a better
												sense of the values...-->
										</ol>
									</li>
									<li>The rules of set are applied, finding all sets.</li>
									<li>Graphics overlays are generated to show outline contours, cards, and sets,
										as well as overlaying text to show the identified attributes. A key and fps
										indicator are shown as well.</li>
								</ol>
							Finally, there are a few calibration routines. In general, just bring focus to the main window
							and press 'c' to calibrate. The program will identify the different cards and recalibrate
							for the current lighting condition. There are a few manual calibrations as well, but that
							one is fully automated, and should get the job done in the vast majority of situations.
							</p>
							<a href="https://github.com/jtclark2/card_shark">Visit the repo</a>
						</div>
					</section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>